# xswl-youdidit

ä¸€ä¸ªé«˜æ€§èƒ½çš„ä»»åŠ¡ä»£ç†å¹³å°åº“ï¼Œé‡‡ç”¨èµé‡‘æ¦œæ¸¸æˆæœºåˆ¶ï¼Œæ”¯æŒå¤šè§’è‰²ä»»åŠ¡äº¤äº’ä¸å®æ—¶ç›‘æ§ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

**xswl-youdidit** æ˜¯ä¸€ä¸ªä»»åŠ¡åˆ†å¸ƒå¼å¤„ç†å¹³å°ï¼Œæ¨¡æ‹ŸçœŸå®ä¸–ç•Œçš„èµé‡‘æ¦œç³»ç»Ÿã€‚é€šè¿‡æ¸¸æˆåŒ–çš„ä»»åŠ¡äº¤äº’æœºåˆ¶ï¼Œæ”¯æŒä»»åŠ¡å‘å¸ƒè€…ã€ç”³é¢†è€…ã€åˆ†æ´¾è€…ç­‰å¤šè§’è‰²åä½œï¼Œå®ç°é«˜æ•ˆçš„å¼‚æ­¥ä»»åŠ¡å¤„ç†ä¸çŠ¶æ€è¿½è¸ªã€‚

### è®¾è®¡ç†å¿µ

- **æ¸¸æˆåŒ–æœºåˆ¶**ï¼šå€Ÿé‰´èµé‡‘æ¦œæ¸¸æˆæ¨¡å¼ï¼Œä½¿ä»»åŠ¡äº¤äº’æ›´åŠ ç›´è§‚æœ‰è¶£
- **å®æ—¶ç›‘æ§**ï¼šå®Œæ•´çš„æ—¥å¿—è®°å½•å’Œ Web å¯è§†åŒ–å·¥å…·ï¼Œæ”¯æŒæ—¶é—´å›æ”¾åŠŸèƒ½
- **é«˜æ€§èƒ½å¹¶å‘**ï¼šæ”¯æŒå¤§è§„æ¨¡å¹¶å‘ä»»åŠ¡å¤„ç†å’ŒåŠ¨æ€è°ƒåº¦

## æŠ€æœ¯æ ˆ

- **ç¼–ç¨‹è¯­è¨€**: C++11
- **ç¼–è¯‘å·¥å…·**: CMake
- **ç¼–è¯‘å™¨**: MinGW
- **ä¾èµ–åº“**: tl::optionalã€tl::expected ç­‰ç¬¬ä¸‰æ–¹åº“

## æ ¸å¿ƒç‰¹æ€§

### ä»»åŠ¡å‘å¸ƒä¸ç”³é¢†
- ä»»åŠ¡å‘å¸ƒè€…å¯ä»¥å‘å¸ƒä»»åŠ¡åˆ°å¹³å°
- æ”¯æŒç­‰å¾…ä»»åŠ¡ç”³é¢†ç»“æœã€å¤„ç†ç»“æœã€çŠ¶æ€åé¦ˆ
- ç”³é¢†è€…è´Ÿè´£å¤„ç†ä»»åŠ¡å¹¶åé¦ˆæ‰§è¡ŒçŠ¶æ€
- æ”¯æŒä»»åŠ¡åˆ†æ´¾ï¼Œå‘å¸ƒè€…å¯æŒ‡å®šç‰¹å®šå¤„ç†è€…

### å¹¶å‘ä¸è°ƒåº¦
- æ”¯æŒä»»æ„å¤šä¸ªä»»åŠ¡ç”³é¢†è€…åŒæ—¶å¤„ç†å„ç§ä»»åŠ¡
- æ”¯æŒè®¾ç½®å’Œå®æ—¶è°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§
- æ”¯æŒå¤šè§’è‰²å¹¶å‘äº¤äº’

### æ¶æ„è®¾è®¡
- é‡‡ç”¨ä¿¡å·æ§½æœºåˆ¶ï¼ˆä½¿ç”¨ [xswl-signals](https://github.com/Wang-Jianwei/xswl-signals.git) åº“ï¼‰
- æ¸¸æˆåŒ–è®¾è®¡é£æ ¼ï¼Œç±»ä¼¼çœŸå®ä¸–ç•Œçš„èµé‡‘æ¦œæ¨¡å¼
- ä»£ç æ¥å£å‘½åè´´è¿‘èµé‡‘æ¦œæ¸¸æˆè§’è‰²

### ç›‘æ§ä¸æ—¥å¿—
- è®°å½•å„è§’è‰²äº¤äº’æ—¥å¿—å’ŒçŠ¶æ€åˆ°çŠ¶æ€æ–‡ä»¶
- æä¾› Web å·¥å…·å®æ—¶æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
- æ”¯æŒæ—¶é—´å›æ”¾åŠŸèƒ½ï¼Œå¦‚åŒæ¸¸æˆä»¿çœŸç•Œé¢

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- C++11 æˆ–æ›´é«˜ç‰ˆæœ¬
- CMake 3.10+
- MinGW å·¥å…·é“¾ï¼ˆWindows å¼€å‘ï¼‰

### æ„å»ºé¡¹ç›®

```bash
mkdir build
cd build
cmake ..
make
```

### åŸºæœ¬ä½¿ç”¨æµç¨‹

1. **å‘å¸ƒä»»åŠ¡**ï¼šä»»åŠ¡å‘å¸ƒè€…åˆ›å»ºä»»åŠ¡å¹¶æäº¤åˆ°å¹³å°
2. **ç”³é¢†ä»»åŠ¡**ï¼šå¤„ç†è€…æŸ¥çœ‹å¹¶ç”³é¢†åˆé€‚çš„ä»»åŠ¡
3. **æ‰§è¡Œå¤„ç†**ï¼šç”³é¢†è€…å¤„ç†ä»»åŠ¡å¹¶åé¦ˆçŠ¶æ€
4. **ç›‘æ§æŸ¥çœ‹**ï¼šé€šè¿‡ Web å·¥å…·å®æ—¶ç›‘æ§ä»»åŠ¡è¿›å±•å’Œç³»ç»ŸçŠ¶æ€

### è®¾è®¡æ¨¡å¼

é‡‡ç”¨ç°ä»£ C++ è®¾è®¡æ¨¡å¼ï¼š

- **Fluent API**ï¼šé“¾å¼è°ƒç”¨ï¼Œæé«˜ä»£ç å¯è¯»æ€§
- **æ™ºèƒ½æŒ‡é’ˆ**ï¼šè‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼
- **å‡½æ•°å¼å›è°ƒ**ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼å¤„ç†äº‹ä»¶
- **Result ç±»å‹**ï¼šä½¿ç”¨ `tl::expected` è¿›è¡Œä¼˜é›…çš„é”™è¯¯å¤„ç†

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
xswl-youdidit/
â”œâ”€â”€ include/          # å¤´æ–‡ä»¶
â”œâ”€â”€ src/              # æºä»£ç å®ç°
â”œâ”€â”€ tests/            # æµ‹è¯•ä»£ç 
â”œâ”€â”€ web/              # Web ç›‘æ§å·¥å…·
â”œâ”€â”€ CMakeLists.txt    # æ„å»ºé…ç½®
â””â”€â”€ README.md         # æœ¬æ–‡ä»¶
```

## ğŸ“– æ ¸å¿ƒæ¦‚å¿µ

### ä»»åŠ¡å®šä¹‰

ä»»åŠ¡ï¼ˆTaskï¼‰æ˜¯å¹³å°çš„æ ¸å¿ƒå®ä½“ï¼Œä»£è¡¨éœ€è¦å¤„ç†çš„å·¥ä½œå•å…ƒã€‚

#### ä»»åŠ¡å±æ€§

```cpp
class Task {
public:
    // åŸºæœ¬ä¿¡æ¯
    TaskId id;                    // å”¯ä¸€æ ‡è¯†ç¬¦
    std::string title;            // ä»»åŠ¡æ ‡é¢˜
    std::string description;      // è¯¦ç»†æè¿°
    
    // ä¼˜å…ˆçº§å’Œåˆ†ç±»
    int priority;                 // ä¼˜å…ˆçº§ï¼ˆ1-10ï¼Œæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼‰
    std::string category;         // ä»»åŠ¡ç±»åˆ«
    std::vector<std::string> tags; // ä»»åŠ¡æ ‡ç­¾
    
    // è§’è‰²ç›¸å…³
    std::string publisher_id;     // å‘å¸ƒè€…ID
    tl::optional<std::string> assignee_id;  // æŒ‡å®šå¤„ç†è€…ï¼ˆå¯é€‰ï¼‰
    tl::optional<std::string> claimer_id;   // å®é™…ç”³é¢†è€…ï¼ˆå¯é€‰ï¼‰
    std::string required_role;    // è¦æ±‚çš„è§’è‰²ç±»å‹
    
    // çŠ¶æ€å’Œè¿›åº¦
    TaskStatus status;            // å½“å‰çŠ¶æ€
    int progress;                 // å®Œæˆè¿›åº¦ï¼ˆ0-100ï¼‰
    
    // æ—¶é—´ä¿¡æ¯
    Timestamp created_at;         // åˆ›å»ºæ—¶é—´
    Timestamp published_at;       // å‘å¸ƒæ—¶é—´
    tl::optional<Timestamp> claimed_at;    // ç”³é¢†æ—¶é—´
    tl::optional<Timestamp> started_at;    // å¼€å§‹å¤„ç†æ—¶é—´
    tl::optional<Timestamp> completed_at;  // å®Œæˆæ—¶é—´
    Timestamp deadline;           // æˆªæ­¢æ—¶é—´
    
    // ç»“æœå’Œæ•°æ®
    tl::optional<TaskResult> result;       // ä»»åŠ¡ç»“æœ
    std::map<std::string, std::string> metadata;  // å…ƒæ•°æ®
    
    // å¥–åŠ±ä¿¡æ¯ï¼ˆèµé‡‘æ¦œç‰¹è‰²ï¼‰
    int reward_points;            // å¥–åŠ±ç§¯åˆ†
    std::string reward_type;      // å¥–åŠ±ç±»å‹
    
    // ============ ä¿¡å·æ§½æœºåˆ¶ ============
    
    // ä»»åŠ¡çŠ¶æ€å˜åŒ–ä¿¡å·
    xswl::signal_t<TaskStatus>& sig_status_changed();
    
    // è¿›åº¦æ›´æ–°ä¿¡å·
    xswl::signal_t<int>& sig_progress_updated();
    
    // ä»»åŠ¡å‘å¸ƒä¿¡å·ï¼ˆå‘å¸ƒè€…å‘å¸ƒæ—¶è§¦å‘ï¼‰
    xswl::signal_t<const TaskId&>& sig_published();
    
    // ä»»åŠ¡ç”³é¢†ä¿¡å·
    xswl::signal_t<const TaskId&, const std::string&>& sig_claimed();
    
    // ä»»åŠ¡å¼€å§‹ä¿¡å·
    xswl::signal_t<const TaskId&>& sig_started();
    
    // ä»»åŠ¡å®Œæˆä¿¡å·
    xswl::signal_t<const TaskId&, const TaskResult&>& sig_completed();
    
    // ä»»åŠ¡å¤±è´¥ä¿¡å·
    xswl::signal_t<const TaskId&, const std::string&>& sig_failed();
    
    // ä¼˜å…ˆçº§è°ƒæ•´ä¿¡å·
    xswl::signal_t<int, int>& sig_priority_changed();
};

// ä¾¿åˆ©æ–¹æ³•ï¼ˆFluent APIï¼‰
class Task {
public:
    // ...å…¶ä»–æ–¹æ³•...
    
    // ä½¿ç”¨ Fluent API æ›´æ–°çŠ¶æ€å¹¶è‡ªåŠ¨è§¦å‘ä¿¡å·
    Task& set_status(TaskStatus status);
    Task& set_progress(int progress);
    Task& set_priority(int new_priority);
    Task& set_result(const TaskResult& result);
};
```

#### ä»»åŠ¡çŠ¶æ€ï¼ˆTaskStatusï¼‰

ä»»åŠ¡åœ¨ç”Ÿå‘½å‘¨æœŸä¸­ä¼šç»å†ä»¥ä¸‹çŠ¶æ€ï¼š

| çŠ¶æ€ | æšä¸¾å€¼ | æè¿° | å¯è½¬æ¢åˆ° |
|------|--------|------|----------|
| **å¾…å‘å¸ƒ** | `Draft` | ä»»åŠ¡å·²åˆ›å»ºï¼Œå°šæœªå‘å¸ƒåˆ°å¹³å° | Published |
| **å·²å‘å¸ƒ** | `Published` | ä»»åŠ¡å·²å‘å¸ƒï¼Œç­‰å¾…ç”³é¢† | Claimed, Cancelled |
| **å·²ç”³é¢†** | `Claimed` | å·²è¢«å¤„ç†è€…ç”³é¢†ï¼Œå‡†å¤‡å¼€å§‹ | Processing, Abandoned |
| **å¤„ç†ä¸­** | `Processing` | æ­£åœ¨æ‰§è¡Œå¤„ç† | Paused, Completed, Failed |
| **æš‚åœ** | `Paused` | æš‚æ—¶åœæ­¢å¤„ç† | Processing, Abandoned |
| **å·²å®Œæˆ** | `Completed` | ä»»åŠ¡æˆåŠŸå®Œæˆ | - |
| **å¤±è´¥** | `Failed` | ä»»åŠ¡å¤„ç†å¤±è´¥ | Published, Abandoned |
| **å·²å–æ¶ˆ** | `Cancelled` | å‘å¸ƒè€…å–æ¶ˆä»»åŠ¡ | - |
| **å·²æ”¾å¼ƒ** | `Abandoned` | ç”³é¢†è€…æ”¾å¼ƒä»»åŠ¡ | Published |

#### çŠ¶æ€è½¬æ¢å›¾

```
Draft â”€â”€â†’ Published â”€â”€â†’ Claimed â”€â”€â†’ Processing â”€â”€â†’ Completed
           â”‚             â”‚           â”‚
           â†“             â†“           â†“
        Cancelled    Abandoned    Failed â”€â”€â†’ Published
                                      â”‚
                                      â†“
                                  Paused
```

### è§’è‰²å®šä¹‰

| è§’è‰² | èŒè´£ | åŠŸèƒ½ |
|------|------|------|
| **å‘å¸ƒè€…** | åˆ›å»ºä»»åŠ¡ | å‘å¸ƒã€åˆ†æ´¾ã€ç›‘æ§ä»»åŠ¡ |
| **ç”³é¢†è€…** | å¤„ç†ä»»åŠ¡ | ç”³é¢†ã€æ‰§è¡Œã€åé¦ˆçŠ¶æ€ |
| **åˆ†æ´¾è€…** | æŒ‡å®šå¤„ç†è€… | ç²¾å‡†åˆ†é…ä»»åŠ¡ç»™ç‰¹å®šç”³é¢†è€… |

### ç”³é¢†è€…å®šä¹‰ï¼ˆClaimerï¼‰

ç”³é¢†è€…ï¼ˆClaimerï¼‰æ˜¯ä»»åŠ¡çš„å®é™…æ‰§è¡Œè€…ï¼Œè´Ÿè´£ä»å¹³å°ç”³é¢†å¹¶å¤„ç†ä»»åŠ¡ã€‚

#### ç”³é¢†è€…å±æ€§

```cpp
class Claimer {
public:
    // åŸºæœ¬ä¿¡æ¯
    std::string id;               // ç”³é¢†è€…å”¯ä¸€æ ‡è¯†
    std::string name;             // ç”³é¢†è€…åç§°
    std::string role;             // è§’è‰²ç±»å‹ï¼ˆå¦‚ "DataProcessor", "Analyst"ï¼‰
    
    // èƒ½åŠ›ä¿¡æ¯
    std::vector<std::string> skills;      // æŠ€èƒ½åˆ—è¡¨
    std::set<std::string> categories;     // å¯å¤„ç†çš„ä»»åŠ¡ç±»åˆ«
    int max_concurrent_tasks;             // æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°
    
    // çŠ¶æ€ä¿¡æ¯
    ClaimerStatus status;         // å½“å‰çŠ¶æ€ï¼ˆç©ºé—²/å¿™ç¢Œ/ç¦»çº¿ï¼‰
    int active_task_count;        // å½“å‰å¤„ç†ä»»åŠ¡æ•°
    std::vector<TaskId> claimed_tasks;    // å·²ç”³é¢†çš„ä»»åŠ¡åˆ—è¡¨
    
    // ç»Ÿè®¡ä¿¡æ¯
    int total_completed;          // ç´¯è®¡å®Œæˆä»»åŠ¡æ•°
    int total_failed;             // ç´¯è®¡å¤±è´¥ä»»åŠ¡æ•°
    int total_abandoned;          // ç´¯è®¡æ”¾å¼ƒä»»åŠ¡æ•°
    double success_rate;          // æˆåŠŸç‡
    int reputation_points;        // å£°æœ›å€¼ï¼ˆèµé‡‘æ¦œç‰¹è‰²ï¼‰
    int total_rewards;            // ç´¯è®¡è·å¾—å¥–åŠ±
    
    // æ—¶é—´ä¿¡æ¯
    Timestamp registered_at;      // æ³¨å†Œæ—¶é—´
    Timestamp last_active_at;     // æœ€åæ´»è·ƒæ—¶é—´
};
```

#### ç”³é¢†è€…çŠ¶æ€ï¼ˆClaimerStatusï¼‰

| çŠ¶æ€ | æšä¸¾å€¼ | æè¿° |
|------|--------|------|
| **ç©ºé—²** | `Idle` | å¯ä»¥ç”³é¢†æ–°ä»»åŠ¡ |
| **å¿™ç¢Œ** | `Busy` | å·²è¾¾åˆ°æœ€å¤§å¹¶å‘ä»»åŠ¡æ•° |
| **ç¦»çº¿** | `Offline` | æš‚æ—¶ä¸å¯ç”¨ |
| **æš‚åœ** | `Paused` | æš‚åœæ¥å—æ–°ä»»åŠ¡ |

#### ç”³é¢†è€…æ ¸å¿ƒæ–¹æ³•

ç”³é¢†è€…ä½¿ç”¨**ä¿¡å·æ§½æœºåˆ¶**ï¼ˆ[xswl-signals](https://github.com/Wang-Jianwei/xswl-signals.git) åº“ï¼‰æš´éœ²å…³é”®äº‹ä»¶ï¼š

```cpp
class Claimer {
public:
    // æ„é€ å‡½æ•°
    Claimer(const std::string& id, const std::string& name);
    
    // ä»»åŠ¡ç”³é¢†
    tl::expected<TaskReference, Error> claim_task(const TaskId& task_id);
    tl::expected<TaskReference, Error> try_claim(const TaskId& task_id);
    
    // ä»»åŠ¡å¤„ç†
    tl::expected<void, Error> start_task(const TaskId& task_id);
    tl::expected<void, Error> update_progress(const TaskId& task_id, int progress);
    tl::expected<void, Error> complete_task(const TaskId& task_id, const TaskResult& result);
    tl::expected<void, Error> fail_task(const TaskId& task_id, const std::string& reason);
    tl::expected<void, Error> abandon_task(const TaskId& task_id, const std::string& reason);
    
    // çŠ¶æ€ç®¡ç†
    Claimer& set_status(ClaimerStatus status);
    Claimer& set_max_concurrent(int max_count);
    bool can_claim_more() const;
    
    // æŸ¥è¯¢æ–¹æ³•
    std::vector<Task> get_active_tasks() const;
    tl::optional<Task> get_task(const TaskId& task_id) const;
    Statistics get_statistics() const;
    
    // ============ ä¿¡å·æ§½æœºåˆ¶ ============
    
    // ä»»åŠ¡å·²åˆ†é…ä¿¡å·ï¼ˆå½“ä»»åŠ¡è¢«åˆ†æ´¾æˆ–å‘å¸ƒè€…æŒ‡å®šæ­¤ç”³é¢†è€…æ—¶è§¦å‘ï¼‰
    xswl::signal_t<const Task&>& sig_task_assigned();
    
    // ä»»åŠ¡å¼€å§‹ä¿¡å·
    xswl::signal_t<const Task&>& sig_task_started();
    
    // ä»»åŠ¡è¿›åº¦æ›´æ–°ä¿¡å·
    xswl::signal_t<const TaskId&, int>& sig_progress_updated();
    
    // ä»»åŠ¡å®Œæˆä¿¡å·
    xswl::signal_t<const Task&, const TaskResult&>& sig_task_completed();
    
    // ä»»åŠ¡å¤±è´¥ä¿¡å·
    xswl::signal_t<const Task&, const std::string&>& sig_task_failed();
    
    // ä»»åŠ¡æ”¾å¼ƒä¿¡å·
    xswl::signal_t<const Task&, const std::string&>& sig_task_abandoned();
    
    // ç”³é¢†è€…çŠ¶æ€å˜åŒ–ä¿¡å·
    xswl::signal_t<ClaimerStatus>& sig_status_changed();
};
```

#### ä½¿ç”¨ç¤ºä¾‹

```cpp
// åˆ›å»ºç”³é¢†è€…
auto claimer = std::make_shared<Claimer>("worker-001", "Alice")
    ->set_role("DataProcessor")
    ->add_skill("data_analysis")
    ->add_skill("machine_learning")
    ->set_max_concurrent(5);

// ä½¿ç”¨ä¿¡å·æ§½æœºåˆ¶æ³¨å†Œäº‹ä»¶å›è°ƒ
claimer->sig_task_assigned().connect([](const Task& task) {
    std::cout << "New task assigned: " << task.title << std::endl;
});

claimer->sig_progress_updated().connect([](const TaskId& task_id, int progress) {
    std::cout << "Task " << task_id << " progress: " << progress << "%" << std::endl;
}, 10);  // ä¼˜å…ˆçº§ä¸º 10

claimer->sig_task_completed().connect([](const Task& task, const TaskResult& result) {
    std::cout << "Task completed: " << task.title << std::endl;
    std::cout << "Result: " << result.summary << std::endl;
});

claimer->sig_task_failed().connect([](const Task& task, const std::string& reason) {
    std::cout << "Task failed: " << task.title << " - " << reason << std::endl;
});

claimer->sig_status_changed().connect([](ClaimerStatus status) {
    std::cout << "Status changed to: " << status.to_string() << std::endl;
}, 5);

// ç”³é¢†ä»»åŠ¡
auto result = claimer->claim_task(task_id);
if (result) {
    auto task_ref = result.value();
    
    // å¼€å§‹å¤„ç†
    task_ref.start();
    
    // æ›´æ–°è¿›åº¦
    task_ref.update_progress(50);  // è§¦å‘ sig_progress_updated ä¿¡å·
    
    // å®Œæˆä»»åŠ¡
    task_ref.complete("Processing completed successfully");  // è§¦å‘ sig_task_completed ä¿¡å·
} else {
    std::cerr << "Claim failed: " << result.error() << std::endl;
}
```

### ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ

1. **å¾…å‘å¸ƒ** â†’ ä»»åŠ¡åˆ›å»ºåˆå§‹çŠ¶æ€
2. **å·²å‘å¸ƒ** â†’ ä»»åŠ¡è¿›å…¥å¹³å°ï¼Œç­‰å¾…ç”³é¢†
3. **å·²ç”³é¢†** â†’ ç”³é¢†è€…å¼€å§‹å¤„ç†
4. **å¤„ç†ä¸­** â†’ ä»»åŠ¡æ‰§è¡Œé˜¶æ®µï¼Œå®šæœŸåé¦ˆçŠ¶æ€
5. **å·²å®Œæˆ** â†’ ä»»åŠ¡å¤„ç†å®Œæˆï¼Œåé¦ˆæœ€ç»ˆç»“æœ

### äº¤äº’æµç¨‹å›¾

ä»¥ä¸‹æ³³é“å›¾å±•ç¤ºäº†ä»»åŠ¡ä»å‘å¸ƒåˆ°å®Œæˆçš„å®Œæ•´äº¤äº’æµç¨‹ï¼š

```mermaid
sequenceDiagram
    actor Publisher as å‘å¸ƒè€…
    participant Platform as ä»»åŠ¡å¹³å°
    participant Task as ä»»åŠ¡å¯¹è±¡
    actor Claimer as ç”³é¢†è€…
    participant WebUI as Webç›‘æ§

    %% ä»»åŠ¡å‘å¸ƒæµç¨‹
    Publisher->>Platform: åˆ›å»ºä»»åŠ¡
    Platform->>Task: å®ä¾‹åŒ– Task
    Publisher->>Task: è®¾ç½®å±æ€§(title, priority, description)
    Publisher->>Platform: publish_task()
    Task->>Task: çŠ¶æ€: Draft â†’ Published
    Task-->>Publisher: sig_published ä¿¡å·
    Task-->>WebUI: è®°å½•æ—¥å¿—
    
    %% ä»»åŠ¡ç”³é¢†æµç¨‹
    Claimer->>Platform: æŸ¥è¯¢å¯ç”³é¢†ä»»åŠ¡
    Platform-->>Claimer: è¿”å›ä»»åŠ¡åˆ—è¡¨
    Claimer->>Platform: claim_task(task_id)
    Platform->>Task: æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
    Task->>Task: çŠ¶æ€: Published â†’ Claimed
    Task-->>Claimer: sig_claimed ä¿¡å·
    Task-->>Publisher: sig_claimed ä¿¡å·
    Task-->>WebUI: è®°å½•ç”³é¢†æ—¥å¿—
    Platform-->>Claimer: è¿”å› TaskReference
    
    %% ä»»åŠ¡å¤„ç†æµç¨‹
    Claimer->>Task: start_task()
    Task->>Task: çŠ¶æ€: Claimed â†’ Processing
    Task-->>Claimer: sig_started ä¿¡å·
    Task-->>Publisher: sig_started ä¿¡å·
    Task-->>WebUI: è®°å½•å¼€å§‹æ—¥å¿—
    
    %% è¿›åº¦æ›´æ–°æµç¨‹
    loop å¤„ç†è¿‡ç¨‹
        Claimer->>Task: update_progress(50)
        Task-->>Claimer: sig_progress_updated ä¿¡å·
        Task-->>Publisher: sig_progress_updated ä¿¡å·
        Task-->>WebUI: å®æ—¶æ›´æ–°è¿›åº¦
    end
    
    %% ä»»åŠ¡å®Œæˆæµç¨‹
    Claimer->>Task: complete_task(result)
    Task->>Task: çŠ¶æ€: Processing â†’ Completed
    Task-->>Claimer: sig_completed ä¿¡å·
    Task-->>Publisher: sig_completed ä¿¡å·
    Task-->>WebUI: è®°å½•å®Œæˆæ—¥å¿—
    Platform->>Claimer: æ›´æ–°ç»Ÿè®¡ä¿¡æ¯(reputation_points++)
    
    %% å¼‚å¸¸æµç¨‹ï¼ˆå¯é€‰ï¼‰
    Note over Claimer,Task: å¼‚å¸¸æƒ…å†µ
    alt ä»»åŠ¡å¤±è´¥
        Claimer->>Task: fail_task(reason)
        Task->>Task: çŠ¶æ€: Processing â†’ Failed
        Task-->>Publisher: sig_failed ä¿¡å·
        Task-->>WebUI: è®°å½•å¤±è´¥æ—¥å¿—
    else ä»»åŠ¡æ”¾å¼ƒ
        Claimer->>Task: abandon_task(reason)
        Task->>Task: çŠ¶æ€: Claimed/Processing â†’ Abandoned
        Task-->>Publisher: sig_task_abandoned ä¿¡å·
        Task-->>WebUI: è®°å½•æ”¾å¼ƒæ—¥å¿—
        Task->>Task: çŠ¶æ€: Abandoned â†’ Published
    end
    
    %% Webç›‘æ§å›æ”¾
    WebUI->>WebUI: æ—¶é—´å›æ”¾åŠŸèƒ½
    Note over WebUI: æ”¯æŒæŸ¥çœ‹å®Œæ•´äº¤äº’å†å²
```

**æµç¨‹è¯´æ˜**ï¼š

1. **ä»»åŠ¡å‘å¸ƒé˜¶æ®µ**ï¼šå‘å¸ƒè€…åˆ›å»ºä»»åŠ¡å¹¶å‘å¸ƒåˆ°å¹³å°ï¼Œè§¦å‘ `sig_published` ä¿¡å·
2. **ä»»åŠ¡ç”³é¢†é˜¶æ®µ**ï¼šç”³é¢†è€…æŸ¥è¯¢å¹¶ç”³é¢†ä»»åŠ¡ï¼Œè§¦å‘ `sig_claimed` ä¿¡å·é€šçŸ¥å‘å¸ƒè€…å’Œç”³é¢†è€…
3. **ä»»åŠ¡å¤„ç†é˜¶æ®µ**ï¼šç”³é¢†è€…å¼€å§‹å¤„ç†å¹¶å®šæœŸæ›´æ–°è¿›åº¦ï¼Œé€šè¿‡ `sig_progress_updated` å®æ—¶åé¦ˆ
4. **ä»»åŠ¡å®Œæˆé˜¶æ®µ**ï¼šæˆåŠŸå®Œæˆè§¦å‘ `sig_completed` ä¿¡å·ï¼Œç³»ç»Ÿæ›´æ–°ç”³é¢†è€…å£°æœ›å€¼
5. **å¼‚å¸¸å¤„ç†**ï¼šæ”¯æŒä»»åŠ¡å¤±è´¥æˆ–æ”¾å¼ƒï¼Œæ”¾å¼ƒåä»»åŠ¡é‡æ–°å›åˆ°å·²å‘å¸ƒçŠ¶æ€ç­‰å¾…å…¶ä»–ç”³é¢†è€…
6. **Webç›‘æ§**ï¼šå…¨ç¨‹è®°å½•æ—¥å¿—ï¼Œæ”¯æŒæ—¶é—´å›æ”¾æŸ¥çœ‹å®Œæ•´äº¤äº’å†å²

*æ³¨ï¼šå›¾ä¸­è™šçº¿ç®­å¤´(`-->>`)è¡¨ç¤ºä¿¡å·æ§½çš„å¼‚æ­¥é€šçŸ¥ï¼Œå®çº¿ç®­å¤´(`->>`)è¡¨ç¤ºç›´æ¥æ–¹æ³•è°ƒç”¨*

## ğŸ’¡ ä¸»è¦ç‰¹æ€§è¯¦è§£

### å¤šä¼˜å…ˆçº§è°ƒåº¦

æ”¯æŒåŠ¨æ€è®¾ç½®å’Œè°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§ï¼Œç¡®ä¿é«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¼˜å…ˆå¤„ç†ï¼š

- **å®æ—¶è°ƒæ•´**ï¼šå¯åœ¨ä»»åŠ¡å¤„ç†å‰åè°ƒæ•´ä¼˜å…ˆçº§
- **å…¬å¹³è°ƒåº¦**ï¼šç›¸åŒä¼˜å…ˆçº§ä»»åŠ¡æŒ‰ FIFO å¤„ç†
- **ä¼˜å…ˆçº§èŒƒå›´**ï¼šæ”¯æŒè‡ªå®šä¹‰ä¼˜å…ˆçº§æ•°å€¼èŒƒå›´

### å¹¶å‘å¤„ç†

- æ”¯æŒå¤šä¸ªç”³é¢†è€…åŒæ—¶å¤„ç†ä¸åŒä»»åŠ¡
- çº¿ç¨‹å®‰å…¨çš„ä»»åŠ¡åˆ†é…å’ŒçŠ¶æ€åŒæ­¥
- è‡ªåŠ¨å¤„ç†å¹¶å‘å†²çªå’Œèµ„æºç«äº‰

## ğŸ” ä¿¡å·æ§½æœºåˆ¶è¯¦è§£

é¡¹ç›®é‡‡ç”¨ [xswl-signals](https://github.com/Wang-Jianwei/xswl-signals.git) åº“å®ç°äº‹ä»¶é©±åŠ¨ï¼Œæä¾›ç±»å‹å®‰å…¨çš„ä¿¡å·æ§½æœºåˆ¶ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æœŸç±»å‹æ£€æŸ¥ï¼Œæ§½å‡½æ•°ç­¾åçµæ´»
- **å‚æ•°é€‚é…**ï¼šæ§½å‡½æ•°å¯æ¥å—æ¯”ä¿¡å·æ›´å°‘çš„å‚æ•°
- **ä¼˜å…ˆçº§è°ƒåº¦**ï¼šæ”¯æŒæŒ‰ä¼˜å…ˆçº§é¡ºåºæ‰§è¡Œæ§½å‡½æ•°
- **å•æ¬¡è¿æ¥**ï¼šæ”¯æŒ `connect_once` ä¸€æ¬¡æ€§å›è°ƒ
- **è‡ªåŠ¨ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šä½¿ç”¨ `shared_ptr` è‡ªåŠ¨è¿½è¸ªå¯¹è±¡ç”Ÿå‘½å‘¨æœŸ
- **çº¿ç¨‹å®‰å…¨**ï¼šåŸºç¡€çº¿ç¨‹å®‰å…¨ä¿è¯ï¼Œé€‚åˆä¸€èˆ¬åœºæ™¯

### ä½¿ç”¨æ¨¡å¼

```cpp
// æ¨¡å¼ 1ï¼šLambda è¿æ¥ï¼ˆæœ€å¸¸ç”¨ï¼‰
task->sig_status_changed().connect([](TaskStatus status) {
    std::cout << "Task status: " << status.name() << std::endl;
});

// æ¨¡å¼ 2ï¼šæˆå‘˜å‡½æ•°è¿æ¥ï¼ˆè‡ªåŠ¨ç”Ÿå‘½å‘¨æœŸè¿½è¸ªï¼‰
auto handler = std::make_shared<EventHandler>();
task->sig_completed().connect(handler, &EventHandler::on_task_complete);

// æ¨¡å¼ 3ï¼šä¼˜å…ˆçº§è°ƒåº¦
claimer->sig_progress_updated().connect([](const TaskId& id, int progress) {
    std::cout << "Progress: " << progress << "%" << std::endl;
}, 100);  // ä¼˜å…ˆçº§ä¸º 100

// æ¨¡å¼ 4ï¼šå•æ¬¡æ‰§è¡Œ
task->sig_published().connect_once([](const TaskId& id) {
    std::cout << "Task published first time" << std::endl;
});

// æ¨¡å¼ 5ï¼šè¿æ¥ç®¡ç†ï¼ˆRAII é£æ ¼ï¼‰
{
    xswl::scoped_connection_t conn = task->sig_status_changed().connect([](TaskStatus status) {
        std::cout << "Inside scope" << std::endl;
    });
    
    task->set_status(TaskStatus::Processing);  // è§¦å‘ä¿¡å·
}  // conn ææ„ï¼Œè‡ªåŠ¨æ–­å¼€è¿æ¥

task->set_status(TaskStatus::Completed);  // ä¸ä¼šè§¦å‘ä¹‹å‰çš„å›è°ƒ

// æ¨¡å¼ 6ï¼šæ‰¹é‡ç®¡ç†ï¼ˆè¿æ¥ç»„ï¼‰
xswl::connection_group_t conns;
conns += task->sig_status_changed().connect([](TaskStatus status) { /* ... */ });
conns += task->sig_progress_updated().connect([](int progress) { /* ... */ });

conns.disconnect_all();  // ä¸€æ¬¡æ€§æ–­å¼€æ‰€æœ‰è¿æ¥
```

### ä¿¡å·åˆ—è¡¨

| å¯¹è±¡ | ä¿¡å·å | å‚æ•° | è§¦å‘æ—¶æœº |
|------|--------|------|---------|
| **Task** | `sig_status_changed()` | `TaskStatus` | ä»»åŠ¡çŠ¶æ€å˜åŒ– |
| | `sig_progress_updated()` | `int` | è¿›åº¦æ›´æ–° |
| | `sig_published()` | `TaskId` | ä»»åŠ¡å‘å¸ƒ |
| | `sig_claimed()` | `TaskId, string` | ä»»åŠ¡è¢«ç”³é¢† |
| | `sig_started()` | `TaskId` | å¼€å§‹å¤„ç† |
| | `sig_completed()` | `TaskId, TaskResult` | å¤„ç†å®Œæˆ |
| | `sig_failed()` | `TaskId, string` | å¤„ç†å¤±è´¥ |
| | `sig_priority_changed()` | `int, int` | ä¼˜å…ˆçº§å˜åŒ– |
| **Claimer** | `sig_task_assigned()` | `Task` | ä»»åŠ¡åˆ†æ´¾ |
| | `sig_task_started()` | `Task` | ä»»åŠ¡å¼€å§‹ |
| | `sig_progress_updated()` | `TaskId, int` | è¿›åº¦æ›´æ–° |
| | `sig_task_completed()` | `Task, TaskResult` | ä»»åŠ¡å®Œæˆ |
| | `sig_task_failed()` | `Task, string` | ä»»åŠ¡å¤±è´¥ |
| | `sig_task_abandoned()` | `Task, string` | ä»»åŠ¡æ”¾å¼ƒ |
| | `sig_status_changed()` | `ClaimerStatus` | ç”³é¢†è€…çŠ¶æ€å˜åŒ– |

## ğŸ” ç›‘æ§ä¸å¯è§†åŒ–

### çŠ¶æ€æ–‡ä»¶

ç³»ç»Ÿè‡ªåŠ¨è®°å½•æ‰€æœ‰æ“ä½œæ—¥å¿—åˆ°çŠ¶æ€æ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼š
- ä»»åŠ¡å‘å¸ƒ/ç”³é¢†/å®Œæˆäº‹ä»¶
- ä¼˜å…ˆçº§è°ƒæ•´è®°å½•
- å„è§’è‰²äº¤äº’å†å²

### Web å·¥å…·åŠŸèƒ½

- **å®æ—¶ä»ªè¡¨æ¿**ï¼šå±•ç¤ºå½“å‰ä»»åŠ¡åˆ†å¸ƒã€ç”³é¢†è€…çŠ¶æ€
- **æ—¶é—´å›æ”¾**ï¼šé€šè¿‡æ—¶é—´è½´æŸ¥çœ‹ä»»åŠ¡å¤„ç†è¿‡ç¨‹
- **äº¤äº’æ—¥å¿—**ï¼šè¯¦ç»†çš„æ“ä½œå’ŒçŠ¶æ€å˜åŒ–è®°å½•

## ğŸ“¦ ä¾èµ–åº“

- **tl::optional** - å¯é€‰å€¼å¤„ç†ï¼Œæ”¯æŒç°ä»£ C++ é£æ ¼çš„å¯é€‰ç±»å‹
- **tl::expected** - ä¼˜é›…çš„é”™è¯¯å¤„ç†ï¼Œæä¾› Result ç±»å‹è¯­ä¹‰
- **xswl-signals** - ä¿¡å·æ§½æœºåˆ¶ï¼Œå®ç°ç±»å‹å®‰å…¨çš„äº‹ä»¶ç³»ç»Ÿ

## ğŸ¯ ç°ä»£ C++ ç‰¹æ€§

é¡¹ç›®å……åˆ†åˆ©ç”¨ C++11 åŠæ›´æ–°ç‰¹æ€§ï¼š

| ç‰¹æ€§ | ç”¨é€” |
|------|------|
| **æ™ºèƒ½æŒ‡é’ˆ** | è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œé¿å…æ‰‹åŠ¨ delete |
| **Lambda è¡¨è¾¾å¼** | çµæ´»çš„å›è°ƒå’Œäº‹ä»¶å¤„ç† |
| **Move è¯­ä¹‰** | é«˜æ•ˆçš„èµ„æºè½¬ç§»å’Œé¿å…æ‹·è´ |
| **std::function** | ç±»å‹æ“¦é™¤çš„å‡½æ•°åŒ…è£… |
| **Fluent API** | é“¾å¼è°ƒç”¨ï¼Œæå‡ä»£ç å¯è¯»æ€§ |
| **Builder æ¨¡å¼** | å¤æ‚å¯¹è±¡çš„çµæ´»æ„å»º |
| **Result/Optional** | å‡½æ•°å¼çš„é”™è¯¯å¤„ç† |

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ç¤ºä¾‹ï¼ˆFluent API é£æ ¼ï¼‰

```cpp
#include <xswl/youdidit.hpp>
#include <memory>

using namespace xswl::youdidit;

// åˆ›å»ºå¹¶é…ç½®ä»»åŠ¡å¹³å°
auto platform = std::make_shared<TaskPlatform>()
    ->set_log_file("platform.log")
    ->enable_web_server(8080);

// ä½¿ç”¨ Fluent API å‘å¸ƒä»»åŠ¡
auto task = platform->task_builder()
    .title("Process Data")
    .priority(5)
    .description("å¤„ç†ç”¨æˆ·æ•°æ®")
    .assign_to_role("DataProcessor")
    .build();

// ç”³é¢†ä»»åŠ¡
auto claimer = std::make_shared<Claimer>("Worker-001");
auto result = claimer->claim_task(task.id());

if (result) {
    // ä»»åŠ¡ç”³é¢†æˆåŠŸ
    auto task_ref = result.value();
    
    // æ³¨å†ŒçŠ¶æ€å˜åŒ–å›è°ƒ
    task_ref.on_status_change([](const TaskStatus& status) {
        std::cout << "Task status: " << status.name() << std::endl;
    });
    
    // æ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼ˆFluent é£æ ¼ï¼‰
    task_ref.status(TaskStatus::Processing)
            .progress(25)
            .update();
    
    task_ref.status(TaskStatus::Completed)
            .result("Data processed successfully")
            .update();
} else {
    // å¤„ç†ç”³é¢†å¤±è´¥
    std::cerr << "Failed to claim task: " << result.error() << std::endl;
}
```

### é«˜çº§ç¤ºä¾‹ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰

```cpp
// åˆ›å»ºå¹³å°å’Œå¤„ç†è€…
auto platform = std::make_shared<TaskPlatform>();
auto handler = std::make_shared<EventHandler>();

// è®¢é˜…ä»»åŠ¡å‘å¸ƒäº‹ä»¶
platform->sig_task_published().connect([handler](const Task& task) {
    handler->process_new_task(task);
});

// è®¢é˜…ä»»åŠ¡å®Œæˆäº‹ä»¶
platform->sig_task_completed().connect([](const Task& task, const Result& result) {
    std::cout << "âœ“ Task " << task.id() << " completed" << std::endl;
});

// å‘å¸ƒä»»åŠ¡
std::vector<std::string> workers = {"Worker-001", "Worker-002", "Worker-003"};

for (int i = 0; i < 10; ++i) {
    auto task = platform->task_builder()
        .title("Task " + std::to_string(i))
        .priority(i % 3 + 1)
        .build();
    
    // è®©ä»»æ„å¯ç”¨çš„å¤„ç†è€…ç”³é¢†
    for (const auto& worker : workers) {
        auto claimer = std::make_shared<Claimer>(worker);
        if (auto res = claimer->try_claim(task.id())) {
            break;  // ç”³é¢†æˆåŠŸï¼Œé€€å‡ºå¾ªç¯
        }
    }
}
```

### Web ç›‘æ§ç¤ºä¾‹

```cpp
// å¯ç”¨ Web å¯è§†åŒ–å·¥å…·
auto platform = std::make_shared<TaskPlatform>()
    ->enable_web_dashboard(8080)
    ->enable_time_replay();

// è®¿é—® http://localhost:8080 æŸ¥çœ‹å®æ—¶ä»ªè¡¨æ¿
// æ”¯æŒæ—¶é—´å›æ”¾ã€äº¤äº’æ—¥å¿—æŸ¥çœ‹ç­‰åŠŸèƒ½
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ LICENSE æ–‡ä»¶ã€‚

---

**å¼€å‘è€…**: [Wang-Jianwei](https://github.com/Wang-Jianwei)

**æœ€åæ›´æ–°**: 2026-01-26